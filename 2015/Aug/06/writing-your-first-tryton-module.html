<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Writing your first Tryton module</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="author" content="Prakash Pandey">
<meta name="tags" content="tryton, python, erp, "/>
<meta name="date" content="06 Aug 2015"/>
<meta name="category" content="tryton"/>
<meta name="summary" content="<p>Blog on how to write your first tryton module</p>>
    <link href="http://prakashpandey.in/theme/css/fonts.css" rel="stylesheet">
    <link href="http://prakashpandey.in/theme/css/milk.min.css" rel="stylesheet">
    <link href="http://prakashpandey.in/theme/css/milk-responsive.min.css" rel="stylesheet">
    <link href="http://prakashpandey.in/theme/css/style.css" rel="stylesheet">
    <link href="http://prakashpandey.in/theme/css/highlight.css" rel="stylesheet">
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div id="navbar-inner">
        <div id="logo">
          <a href="/">Prakash Pandey</a>
          <img class="img-circle hidden-phone" src="https://secure.gravatar.com/avatar/a153aa8e81b37f14ef1016672c2fd22a?s=64">
        </div>
      </div>
    </div>
    <div class="container">
      <div class="content">
        <div class="row-fluid">
          <div class="span12">

<article class="post">
	<header>
     	<h1><a href="2015/Aug/06/writing-your-first-tryton-module.html">Writing your first Tryton module</a></h1>
        <time datetime="2015-08-06T23:26:00+02:00" pubdate>06 Aug 2015</time>
    </header>
    <hr>
    <div class="content">
    	<p><a href="http://tryton.org">Tryton</a> is a modular business application, allows you
to extend/change the existing functionality by writing
your own module. Every tryton module is a python package also.
This blog explains on how to write a tryton module.</p>
<h1>Lets Start!</h1>
<p>We are gonna use <a href="https://github.com/fulfilio/cookiecutter-tryton">cookiecutter-tryton</a> boilerplate for this.
I am assuming you are already inside a virtual environment. Lets generate module boilerplate:</p>
<div class="highlight"><pre><span class="nv">$ </span>pip install cookiecutter
<span class="nv">$ </span>cookiecutter git@github.com:fulfilio/cookiecutter-tryton.git
author <span class="o">(</span>default is <span class="s2">&quot;Fulfil.IO Inc.&quot;</span><span class="o">)</span>? Prakash Pandey
email <span class="o">(</span>default is <span class="s2">&quot;info@fulfil.io&quot;</span><span class="o">)</span>? howdy@prakashpandey.in
website <span class="o">(</span>default is <span class="s2">&quot;http://www.fulfil.io/&quot;</span><span class="o">)</span>? http://prakashpandey.in
module_name <span class="o">(</span>default is <span class="s2">&quot;module_name&quot;</span><span class="o">)</span>? helloworld
module_prefix <span class="o">(</span>default is <span class="s2">&quot;trytond&quot;</span><span class="o">)</span>? trytond
description <span class="o">(</span>default is <span class="s2">&quot;&quot;</span><span class="o">)</span>? Hello world module
licence <span class="o">(</span>default is <span class="s2">&quot;BSD&quot;</span><span class="o">)</span>? BSD
repo_name <span class="o">(</span>default is <span class="s2">&quot;module-name&quot;</span><span class="o">)</span>? hello-world
version <span class="o">(</span>default is <span class="s2">&quot;3.4.0.1&quot;</span><span class="o">)</span>? 3.4.0.1
year <span class="o">(</span>default is <span class="s2">&quot;2015&quot;</span><span class="o">)</span>? 2015
</pre></div>


<p>This creates a directory <code>hello-world</code> with following files:</p>
<div class="highlight"><pre><span class="nv">$ </span>tree hello-world
hello-world
├── LICENSE
├── README.rst
├── __init__.py
├── dev_requirements.txt
├── helloworld.py
├── helloworld.xml
├── requirements.txt
├── setup.cfg
├── setup.py
├── tests
│   ├── __init__.py
│   └── test_views_depends.py
├── tox.ini
└── tryton.cfg

<span class="m">1</span> directory, <span class="m">13</span> files
</pre></div>


<h1>Writing models</h1>
<p>Lets create a new model HelloWorld which has a char field name.</p>
<div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    helloworld.py</span>

<span class="sd">    This file contains models.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">trytond.model</span> <span class="kn">import</span> <span class="n">ModelSQL</span><span class="p">,</span> <span class="n">ModelView</span><span class="p">,</span> <span class="n">fields</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;HelloWorld&#39;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">HelloWorld</span><span class="p">(</span><span class="n">ModelSQL</span><span class="p">,</span> <span class="n">ModelView</span><span class="p">):</span>
    <span class="s">&quot;Hello World&quot;</span>
    <span class="n">__name__</span> <span class="o">=</span> <span class="s">&quot;hello.world&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p>Every tryton model must define <code>__name__</code> attribute, identifier for
tryton models.</p>
<h1>Writing view</h1>
<p>Views are written in xml and are stored in database. Tryton has models
for view e.g. <code>ir.ui.view</code>, creating a view is creating a record of this
model. Same goes for action window and menuitems.</p>
<p>Lets create form view and list view for HelloWorld model, <code>helloworld.xml</code>
will look like as follows:</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;tryton&gt;</span>
    <span class="nt">&lt;data&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;helloworld_view_tree&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>hello.world<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="nt">&gt;</span>tree<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>helloworld_tree<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;helloworld_view_form&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>hello.world<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>helloworld_form<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.action.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_hellworld_form&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Hello World<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>hello.world<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.action.act_window.view&quot;</span> <span class="na">id=</span><span class="s">&quot;act_hellworld_form_view1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;sequence&quot;</span> <span class="na">eval=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view&quot;</span> <span class="na">ref=</span><span class="s">&quot;hellworld_view_tree&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_window&quot;</span> <span class="na">ref=</span><span class="s">&quot;act_hellworld_form&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.action.act_window.view&quot;</span> <span class="na">id=</span><span class="s">&quot;act_hellworld_form_view2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;sequence&quot;</span> <span class="na">eval=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view&quot;</span> <span class="na">ref=</span><span class="s">&quot;hellworld_view_form&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_window&quot;</span> <span class="na">ref=</span><span class="s">&quot;act_hellworld_form&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;menuitem</span> <span class="na">sequence=</span><span class="s">&quot;1&quot;</span> <span class="na">action=</span><span class="s">&quot;act_hellworld_form&quot;</span> <span class="na">id=</span><span class="s">&quot;menu_hellworld_form&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/tryton&gt;</span>
</pre></div>


<p>View architecture goes to <code>view</code> directory, create view directory and add
following files inside it:</p>
<p><code>helloworld_form.xml</code></p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;HelloWorld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>


<p><code>helloworld_tree.xml</code></p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;HelloWorld&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tree&gt;</span>
</pre></div>


<h1>Defining dependency</h1>
<p>Every tryton module must have <code>tryton.cfg</code> file. This file defines module dependency,
version and xml files. Our module only depends on ir and res.</p>
<div class="highlight"><pre><span class="k">[tryton]</span>
<span class="na">version</span><span class="o">=</span><span class="s">3.4.0.1</span>
<span class="err">depends:</span>
    <span class="err">ir</span>
    <span class="err">res</span>
<span class="err">xml:</span>
    <span class="err">helloworld.xml</span>
</pre></div>


<h1>Registering into Pool</h1>
<p>This is the final step where we register models into pool. Tryton will not understand the
model until we register it in pool. Registering is done in <code>__init__.py</code></p>
<div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">trytond.pool</span> <span class="kn">import</span> <span class="n">Pool</span>

<span class="kn">from</span> <span class="nn">helloworld</span> <span class="kn">import</span> <span class="n">HelloWorld</span>


<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="n">Pool</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
        <span class="n">HelloWorld</span><span class="p">,</span>
        <span class="n">module</span><span class="o">=</span><span class="s">&#39;helloworld&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s">&#39;model&#39;</span>
    <span class="p">)</span>
</pre></div>


<h1>Yay! we're done!</h1>
<p>Yes we are done. Now install the module into the database and done!</p>
<div class="highlight"><pre><span class="nv">$ </span>pip install .
<span class="nv">$ </span>trytond -c cofig_file_path -u helloworld -d database_name
</pre></div>


<p>This blog is a very brief guide and works for 3.4 and 3.6 version perfectly.
To do more you can take following refernces:</p>
<ul>
<li><a href="http://doc.tryton.org/3.4/">Tryton Documentation and API Reference</a></li>
<li><a href="https://tryton-documentation.readthedocs.org/en/latest/user_guide/index.html">Tryton Readthedocs</a></li>
<li><a href="https://github.com/tryton">Github Mirror</a></li>
</ul>
    </div>
</article>

          </div>
        </div>
        <footer>
          <a class="twitter-follow-button" href="https://twitter.com/prkshpp">Follow @prkshpp</a>
          <a href="mailto:howdy@prakashpandey.in" class="contact">Get in Touch</a>
        </footer>
      </div>
    </div>
    <script src="http://prakashpandey.in/theme/js/highlight.js"></script>
    <script src="http://prakashpandey.in/theme/js/jquery.min.js"></script>
    <script>
      $(document).ready(function() {
        $('div.highlight pre').each(function(i, block) {
          hljs.highlightBlock(block);
        });
      });
    </script>
    <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-65626172-1', 'auto');
          ga('send', 'pageview');
    </script>
  </body>
</html>